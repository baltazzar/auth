/**
 * Baltazzar Auth
 * Versão: 1.0.0
 * Componente de autenticacao da PMS para o novo boiler plate
 * Autor: BaltazZar Team
 */
!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),(b.baltazzar||(b.baltazzar={})).auth=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("jquery"),e=a("underscore"),f=a("backbone"),g=this;f.$=d,c.init=function(a){g.loginUrl=a.loginUrl||"",g.logoutUrl=a.logoutUrl||"",g.loggedUserUrl=a.loggedUserUrl||"",g.loginShowMessageTimer=a.loginShowMessageTimer||3e3,g.appSigla=a.appSigla||"Sigla",g.appDescricao=a.appDescricao||"Descrição",g.appBotao=a.appBotao||"Confirmar"},c.loginView=f.View.extend({events:{"submit .login-block-form":"doLogin"},initialize:function(a){var b=['<div class="login-block">','	<div class="panel panel-default">','		<div class="panel-heading">&nbsp;</div>','		<div class="panel-body">','			<form class="login-block-form">','				<div class="col-md-12 login-block-sigla text-center">'+g.appSigla+"</div>",'				<div class="col-md-12 login-block-descricao">'+g.appDescricao+"</div>",'				<div class="col-md-12">','					<div class="alert alert-danger login-block-message hide"></div>',"				</div>",'				<div class="col-md-12">','					<div class="form-group">','						<input type="text" class="form-control input-sm login-block-username" placeholder="Usuário">',"					</div>","				</div>",'				<div class="col-md-12">','					<div class="form-group">','						<input type="password" class="form-control input-sm login-block-password" placeholder="Senha">',"					</div>","				</div>",'				<div class="col-md-12">','					<button type="SUBMIT" class="btn btn-success btn-block pull-right login-block-confirm">'+g.appBotao+"</button>","				</div>","			</form>","		</div>","	</div>","</div>"].join("");this.template=a._template||b,this.events=e.extend({},this.events,a._events),this.callbackdoLoginOK=a.callbackdoLoginOK||"",this.callbackdoLoginNOK=a.callbackdoLoginNOK||"",this.render()},render:function(){this.$el.html(this.template),this.setaFoco()},setaFoco:function(){this.$("input:first").focus()},login:function(a,b){return d.ajax({method:"POST",url:g.loginUrl,async:!1,cache:!1,data:{login:a,senha:b}})},doLogin:function(a){a.preventDefault();var b=d(".login-block-message"),c=d(".login-block-confirm"),e=this.$(".login-block-username").val(),f=this.$(".login-block-password").val(),h=g.loginShowMessageTimer,i=!1,j=this;c.prop("disabled",!0);var k=this.login(e,f).success(this.callbackdoLoginOK).error(this.callbackdoLoginNOK);return k?(retJSON=k.responseJSON||null,retJSON?retJSON.status&&retJSON.data?i=!0:b.html(retJSON.message).removeClass("hide").fadeIn().delay(h).fadeOut(function(){c.prop("disabled",!1),j.setaFoco()}):b.html(k.statusText).removeClass("hide").fadeIn().delay(h).fadeOut(function(){c.prop("disabled",!1),j.setaFoco()})):(c.prop("disabled",!1),this.setaFoco()),i}}),c.logout=function(){return d.ajax({method:"POST",url:g.logoutUrl,async:!1,cache:!1})},c.isLogged=function(){return d.ajax({method:"GET",url:g.loggedUserUrl,async:!1,cache:!1})}},{}]},{},[1])(1)});